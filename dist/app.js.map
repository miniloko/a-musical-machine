{"version":3,"sources":["audiocable.js","bus.js","envelope.js","main.js","melody.js","note.js","oscillator.js","reverb.js","soundmachine.js","trigger.js","utils.js","visualiser.js"],"names":[],"mappings":";;;;;;;;;;;;IAKM,UAAU;AACf,UADK,UAAU,CACH,YAAY,EAAE;wBADrB,UAAU;;AAEd,MAAI,CAAC,YAAY,GAAG,YAAY,CAAC;AACjC,MAAI,CAAC,KAAK,GAAG,IAAI,CAAC,YAAY,CAAC,UAAU,EAAE,CAAC;EAC5C;;cAJI,UAAU;;4BAML,SAAS,EAAE;AACpB,OAAI,CAAC,KAAK,CAAC,OAAO,CAAC,SAAS,CAAC,CAAC;GAC9B;;;iCAEc,SAAS,EAAE;AACzB,OAAI,CAAC,KAAK,CAAC,UAAU,CAAC,SAAS,CAAC,CAAC;GACjC;;;QAZI,UAAU;;;;;;;;;;;;;;;;;;;;ICEV,GAAG;WAAH,GAAG;;AACR,UADK,GAAG,CACI,YAAY,EAAE;wBADrB,GAAG;;sEAAH,GAAG,aAED,YAAY;;AAClB,SAAK,GAAG,GAAM,IAAI,UAAU,CAAC,YAAY,CAAC,CAAC;AAC3C,SAAK,GAAG,GAAM,IAAI,UAAU,CAAC,YAAY,CAAC,CAAC;AAC3C,SAAK,MAAM,GAAG,IAAI,UAAU,CAAC,YAAY,CAAC,CAAC;AAC3C,SAAK,OAAO,GAAG,IAAI,GAAG,EAAE,CAAC;AACzB,SAAK,IAAI,GAAG,CAAC;;AAAC,AAEd,SAAK,KAAK,CAAC,OAAO,CAAC,OAAK,GAAG,CAAC,KAAK,CAAC,CAAC;AACnC,SAAK,KAAK,CAAC,OAAO,CAAC,OAAK,GAAG,CAAC,KAAK,CAAC;;AAAC,AAEnC,SAAK,GAAG,CAAC,SAAS,CAAC,OAAK,MAAM,CAAC,KAAK,CAAC,CAAC;AACtC,SAAK,GAAG,CAAC,SAAS,CAAC,OAAK,MAAM,CAAC,KAAK,CAAC,CAAC;;EACtC;;cAdI,GAAG;;4BAgBE,SAAS,EAAE;;AAEpB,OAAI,CAAC,MAAM,CAAC,SAAS,CAAC,SAAS,CAAC,CAAC;GACjC;;;iCAEc,SAAS,EAAE;AACzB,OAAI,CAAC,MAAM,CAAC,cAAc,CAAC,SAAS,CAAC,CAAC;GACtC;;;yBAEM;AACN,OAAI,CAAC,MAAM,CAAC,KAAK,CAAC,IAAI,CAAC,KAAK,GAAG,CAAC,CAAC;AACjC,OAAI,CAAC,MAAM,CAAC,KAAK,CAAC,IAAI,CAAC,KAAK,GAAG,CAAC,CAAC;GACjC;;;2BAEQ;AACR,OAAI,CAAC,MAAM,CAAC,KAAK,CAAC,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,IAAI,CAAC;GACzC;;;6BAEU,OAAO,EAAE;AACnB,OAAI,CAAC,GAAG,CAAC,KAAK,CAAC,IAAI,CAAC,KAAK,GAAG,CAAC,GAAG,OAAO,CAAC;AACxC,OAAI,CAAC,GAAG,CAAC,KAAK,CAAC,IAAI,CAAC,KAAK,GAAG,OAAO,CAAC;GACpC;;;+BAEY,MAAM,EAAE;AACpB,OAAI,CAAC,KAAK,CAAC,UAAU,CAAC,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC;AACtC,OAAI,CAAC,OAAO,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;AACzB,OAAI,CAAC,gBAAgB,EAAE,CAAC;GACxB;;;+BAEY,MAAM,EAAE;AACpB,OAAI,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,MAAM,CAAC,EAAE;AAChC,QAAI,CAAC,gBAAgB,EAAE,CAAC;IACxB;GACD;;;qCAEkB;AAClB,OAAI,YAAY,GAAG,CAAC,CAAC;AACrB,OAAI,cAAc,GAAG,EAAE,CAAC;AACxB,OAAI,KAAK,GAAG,IAAI,CAAC;;AAEjB,OAAI,CAAC,OAAO,CAAC,OAAO,CAAC,UAAS,MAAM,EAAE;AACrC,UAAM,CAAC,KAAK,CAAC,UAAU,EAAE;;AAAC,AAE1B,QAAI,YAAY,KAAK,CAAC,EAAE;AACvB,WAAM,CAAC,SAAS,CAAC,KAAK,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC;AAClC,UAAK,CAAC,KAAK,CAAC,OAAO,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC;KAClC,MAAM;AACN,UAAK,CAAC,MAAM,CAAC,SAAS,CAAC,cAAc,CAAC,CAAC;KACvC;;AAED,gBAAY,EAAE,CAAC;AACf,kBAAc,GAAG,MAAM;AAAC,IACxB,CAAC,CAAC;GACH;;;QArEI,GAAG;GAAS,UAAU;;;;;;;;;;;;;;;ICJtB,QAAQ;WAAR,QAAQ;;AACb,UADK,QAAQ,CACD,YAAY,EAAE;wBADrB,QAAQ;;qEAAR,QAAQ,aAEN,YAAY;;AAClB,QAAK,UAAU,GAAG,GAAG;AAAC,AACtB,QAAK,WAAW,GAAG,GAAG;AAAC;EACvB;;cALI,QAAQ;;kCAOG;AACf,OAAI,GAAG,GAAG,IAAI,CAAC,YAAY,CAAC,WAAW,CAAC;AACxC,OAAI,CAAC,KAAK,CAAC,IAAI,CAAC,cAAc,CAAC,GAAG,EAAE,GAAG,CAAC,CAAC;AACzC,OAAI,CAAC,KAAK,CAAC,IAAI,CAAC,uBAAuB,CAAC,GAAG,EAAE,GAAG,GAAG,IAAI,CAAC,UAAU,CAAC,CAAC;AACpE,OAAI,CAAC,KAAK,CAAC,IAAI,CAAC,uBAAuB,CAAC,GAAG,EAAE,GAAG,GAAG,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,WAAW,CAAC,CAAC;GACvF;;;QAZI,QAAQ;GAAS,UAAU;;;ACHjC,CAAC,YAAM;AACN,KAAI,WAAW,GAAG,KAAK,CAAC;AACxB,KAAI,SAAS,GAAG,OAAO,CAAC;AACxB,KAAI,MAAM,GAAG,QAAQ,CAAC,aAAa,CAAC,aAAa,CAAC,CAAA;AAClD,KAAI,cAAc,GAAG,QAAQ,CAAC,cAAc,CAAC,UAAU,CAAC,CAAC;;AAEzD,KAAI,EAAE,GAAG,EAAE,CAAC;AACZ,KAAI,GAAG,GAAG,EAAE,CAAC;;AAEb,KAAI,UAAU,IAAI,MAAM,EACvB,SAAS,GAAG,UAAU,CAAC;;;AAAA,AAGxB,OAAM,CAAC,gBAAgB,CAAC,SAAS,EAAE,WAAW,CAAC,CAAC;;AAEhD,UAAS,WAAW,CAAC,GAAG,EAAE;AACzB,MAAI,CAAC,WAAW,EAAE;AACjB,KAAE,GAAG,IAAI,YAAY,EAAE,CAAC;AACxB,MAAG,GAAG,IAAI,UAAU,CAAC,EAAE,CAAC,YAAY,EAAE,EAAE,CAAC,GAAG,CAAC,MAAM,CAAC,KAAK,EAAE,cAAc,CAAC,WAAW,EAAE,cAAc,CAAC,YAAY,CAAC,CAAC;AACpH,cAAW,GAAG,IAAI,CAAC;GACnB;;AAED,KAAG,CAAC,cAAc,EAAE,CAAC;;AAErB,MAAI,IAAI,GAAG,MAAM,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC;AACxC,MAAI,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC,cAAc,CAAC,EAAE;AAC5C,OAAI,CAAC,SAAS,CAAC,MAAM,CAAC,cAAc,CAAC,CAAC;AACtC,OAAI,CAAC,SAAS,CAAC,GAAG,CAAC,eAAe,CAAC,CAAC;AACpC,KAAE,CAAC,UAAU,EAAE,CAAC;GAEhB,MAAM;AACN,OAAI,CAAC,SAAS,CAAC,MAAM,CAAC,eAAe,CAAC,CAAC;AACvC,OAAI,CAAC,SAAS,CAAC,GAAG,CAAC,cAAc,CAAC,CAAC;AACnC,KAAE,CAAC,SAAS,EAAE,CAAC;GACf;EACD;CACD,CAAA,EAAG,CAAC;;;;;;;ICpCC,eAAe;AACpB,UADK,eAAe,GACN;wBADT,eAAe;;AAEnB,MAAI,CAAC,UAAU,GAAG,CACjB,CAAC,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAI,EAAE,EAAE,IAAI,EAAE,EAAE,CAAC,EAC9C,CAAC,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAI,EAAE,EAAE,EAAE,CAAC,EAC9C,CAAC,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAI,EAAE,EAAE,IAAI,EAAE,EAAE,CAAC,EAC9C,CAAC,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAI,EAAE,EAAE,IAAI,EAAE,IAAI,EAAE,EAAE,CAAC,CAC9C,CAAC;;AAEF,MAAI,CAAC,WAAW,GAAG,CAAC,CAAC;AACrB,MAAI,CAAC,cAAc,GAAG,CAAC,CAAC;EACxB;;cAXI,eAAe;;6BAaT;AACV,OAAI,MAAM,GAAG,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,cAAc,CAAC,CAAC,MAAM,CAAC;AAC5E,OAAI,IAAI,GAAG,EAAE;;;AAAC,AAGd,OAAI,MAAM,KAAK,CAAC,EAAE;AACjB,QAAI,CAAC,cAAc,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,MAAM,EAAE,GAAG,IAAI,CAAC,UAAU,CAAC,MAAM,CAAC,CAAC;AACzE,UAAM,GAAG,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,cAAc,CAAC,CAAC,MAAM,CAAC;IACrD;;AAED,OAAI,GAAG,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,cAAc,CAAC,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;AACxD,OAAI,CAAC,WAAW,EAAE,CAAC;;AAEnB,UAAO,IAAI,KAAK,EAAE,GAAG,IAAI,GAAG,KAAK,CAAA;GACjC;;;QA3BI,eAAe;;;;;;;;;;;;ICGf,IAAI;AACT,UADK,IAAI,CACG,SAAS,EAAE;wBADlB,IAAI;;AAER,MAAI,CAAC,MAAM,GAAG;AACb,gBAAa,EAAE;AACd,aAAS,EAAE,OAAO;AAClB,iBAAa,EAAE,EAAE;AACjB,cAAU,EAAE,CAAC;AACb,aAAS,EAAE,CAAC,EAAE;AACd,aAAS,EAAE,EAAE;IACb;AACD,iBAAc,EAAE;AACf,aAAS,EAAE,kBAAkB;AAC7B,iBAAa,EAAE,UAAU;AACzB,cAAU,EAAE,CAAC;AACb,aAAS,EAAE,CAAC;AACZ,aAAS,EAAE,GAAG;AACd,aAAS,EAAE,CAAC,GAAG,EAAE,IAAI,EAAE,GAAG,EAAE,IAAI,EAAE,GAAG,EAAE,GAAG,EAAE,IAAI,EAAE,GAAG,EAAE,IAAI,EAAE,GAAG,EAAE,IAAI,EAAE,GAAG,CAAC;IAC5E;GACD,CAAC;;AAEF,MAAI,CAAC,QAAQ,CAAC,SAAS,IAAI,eAAe,CAAC,CAAC;EAC5C;;;;;AAAA;cArBI,IAAI;;2BA0BA,SAAS,EAAE;AACnB,OAAI,OAAO,IAAI,CAAC,MAAM,CAAC,SAAS,CAAC,KAAK,WAAW,EAAE;AAClD,QAAI,CAAC,KAAK,GAAG,IAAI,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC;IACpC;GACD;;;;;;;;;iCAMc,MAAM,EAAE;;AAEtB,SAAM,IAAI,IAAI,CAAC,KAAK,CAAC,UAAU;;AAAC,AAEhC,SAAM,GAAG,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,KAAK,CAAC,SAAS,EAAE,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,KAAK,CAAC,SAAS,EAAE,MAAM,CAAC,CAAC;;AAAC,AAEhF,SAAM,GAAG,MAAM,KAAK,CAAC,GAAG,IAAI,CAAC,KAAK,CAAC,UAAU,GAAG,MAAM;;AAAC,AAEvD,UAAO,IAAI,CAAC,KAAK,CAAC,aAAa,GAAG,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,KAAK,CAAC,SAAS,EAAE,MAAM,CAAC,CAAC;GACzE;;;;;;;;;;;;+BASY,UAAU,EAAE;AACxB,OAAI,OAAO,IAAI,CAAC,KAAK,CAAC,SAAS,KAAK,WAAW,EAAE,OAAO;;AAExD,OAAI,WAAW,GAAG,UAAU,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC;AAC3C,OAAI,IAAI,GAAG,WAAW,CAAC,CAAC,CAAC,CAAC;AAC1B,OAAI,GAAG,GAAG,WAAW,CAAC,MAAM,GAAG,CAAC,GAAG,WAAW,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC;AACtD,OAAI,UAAU,GAAG,GAAG,GAAG,IAAI,CAAC,KAAK,CAAC,SAAS,CAAC,MAAM,GAAG,IAAI,CAAC,KAAK,CAAC,SAAS,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;AACxF,UAAO,UAAU,CAAC;GAClB;;;QA9DI,IAAI;;;;;;;;;;;;;;;;;;;;ICIJ,GAAG;WAAH,GAAG;;AACR,UADK,GAAG,CACI,YAAY,EAAE;wBADrB,GAAG;;qEAAH,GAAG,aAED,YAAY;;AAClB,QAAK,OAAO,GAAG,MAAK,YAAY,CAAC,gBAAgB,EAAE,CAAC;AACpD,QAAK,gBAAgB,GAAG,GAAG,CAAC;AAC5B,QAAK,OAAO,CAAC,IAAI,GAAG,MAAM,CAAC;AAC3B,QAAK,OAAO,CAAC,SAAS,CAAC,KAAK,GAAG,MAAK,gBAAgB,CAAC;AACrD,QAAK,OAAO,CAAC,OAAO,CAAC,MAAK,KAAK,CAAC;;;AAAC,AAGjC,QAAK,OAAO,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;;EACtB;;cAXI,GAAG;;2BAYC,YAAY,EAAE;AACtB,OAAI,CAAC,OAAO,CAAC,IAAI,GAAG,YAAY,IAAI,MAAM,CAAC;GAC3C;;;4BACS,EAAE,EAAE;AACb,OAAI,CAAC,OAAO,CAAC,SAAS,CAAC,cAAc,CAAC,EAAE,EAAE,IAAI,CAAC,YAAY,CAAC,WAAW,CAAC,CAAC;GACzE;;;QAjBI,GAAG;GAAS,UAAU;;;;;;;;;;;ICPtB,MAAM;WAAN,MAAM;;AACX,UADK,MAAM,CACC,YAAY,EAAE;wBADrB,MAAM;;qEAAN,MAAM,aAEJ,YAAY;;AAClB,QAAK,OAAO,GAAG,CAAC,CAAC;AACjB,QAAK,KAAK,GAAG,CAAC,CAAC;AACf,QAAK,KAAK,GAAG,MAAK,YAAY,CAAC,eAAe,EAAE;AAAC,AACjD,QAAK,aAAa,EAAE,CAAC;;EACrB;;cAPI,MAAM;;gCASG,MAAM,EAAE,KAAK,EAAE;AAC5B,OAAI,IAAI,GAAG,IAAI,CAAC,YAAY,CAAC,UAAU,CAAC;AACxC,OAAI,MAAM,GAAG,IAAI,GAAG,IAAI,CAAC,OAAO;AAAC,AACjC,OAAI,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC;AACvB,OAAI,OAAO,GAAG,IAAI,CAAC,YAAY,CAAC,YAAY,CAAC,CAAC,EAAE,MAAM,EAAE,IAAI,CAAC,CAAC;AAC9D,OAAI,QAAQ,GAAG,OAAO,CAAC,cAAc,CAAC,CAAC,CAAC,CAAC;AACzC,OAAI,QAAQ,GAAG,OAAO,CAAC,cAAc,CAAC,CAAC,CAAC,CAAC;AACzC,OAAI,CAAC;OAAE,CAAC,GAAG,CAAC,CAAC;;AAEb,UAAO,CAAC,IAAI,CAAC,kBAAkB,CAAC,CAAC;AACjC,UAAO,CAAC,GAAG,MAAM,EAAE,CAAC,EAAE,EAAE;AACvB,KAAC,GAAG,IAAI,CAAC,OAAO,GAAG,MAAM,GAAG,CAAC,GAAG,CAAC,CAAC;AAClC,YAAQ,CAAC,CAAC,CAAC,GAAG,CAAC,IAAI,CAAC,MAAM,EAAE,GAAG,CAAC,GAAG,CAAC,CAAA,GAAI,IAAI,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC,GAAG,MAAM,EAAE,KAAK,CAAC,CAAC;AACxE,YAAQ,CAAC,CAAC,CAAC,GAAG,CAAC,IAAI,CAAC,MAAM,EAAE,GAAG,CAAC,GAAG,CAAC,CAAA,GAAI,IAAI,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC,GAAG,MAAM,EAAE,KAAK,CAAC,CAAC;IACxE;AACD,UAAO,CAAC,OAAO,CAAC,kBAAkB,CAAC,CAAC;;AAEpC,OAAI,CAAC,KAAK,CAAC,MAAM,GAAG,OAAO,CAAC;GAC5B;;;QA3BI,MAAM;GAAS,UAAU;;;;;;;;;;;;ICIzB,YAAY;AACjB,UADK,YAAY,GACH;wBADT,YAAY;;AAEhB,MAAI,YAAY,GAAG,MAAM,CAAC,YAAY,IAAI,MAAM,CAAC,kBAAkB,IAAI,KAAK,CAAC;AAC7E,MAAI,CAAC,YAAY,EAAE,OAAO;;;AAAA,AAG1B,MAAI,CAAC,SAAS,GAAG,CAAC,CAAC;AACnB,MAAI,CAAC,cAAc,GAAG,CAAC,CAAC;AACxB,MAAI,CAAC,MAAM,GAAG,EAAE,CAAC;;AAEjB,MAAI,CAAC,YAAY,GAAG,IAAI,YAAY,EAAE,CAAC;AACvC,MAAI,CAAC,IAAI,GAAW,IAAI,IAAI,CAAC,gBAAgB,CAAC,CAAC;AAC/C,MAAI,CAAC,GAAG,GAAY,IAAI,qBAAqB,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC;AACtD,MAAI,CAAC,MAAM,GAAS,IAAI,eAAe,EAAE,CAAC;AAC1C,MAAI,CAAC,OAAO,GAAQ,IAAI,gBAAgB,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC;AAC5D,MAAI,CAAC,GAAG,GAAY,IAAI,GAAG,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC;AAC/C,MAAI,CAAC,MAAM,GAAS,IAAI,MAAM,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC;AAClD,MAAI,CAAC,QAAQ,GAAO,QAAQ,CAAC,aAAa,CAAC,WAAW,CAAC,CAAC,QAAQ,CAAC;;AAEjE,MAAI,CAAC,GAAG,CAAC,YAAY,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;AACnC,MAAI,CAAC,GAAG,CAAC,UAAU,CAAC,GAAG,CAAC,CAAC;AACzB,MAAI,CAAC,GAAG,CAAC,SAAS,CAAC,IAAI,CAAC,YAAY,CAAC,WAAW,CAAC,CAAC;EAClD;;cAtBI,YAAY;;+BAwBJ;AACZ,OAAI,CAAC,GAAG,CAAC,MAAM,EAAE,CAAC;AAClB,OAAI,CAAC,OAAO,CAAC,MAAM,CAAC,IAAI,CAAC,MAAM,EAAE,IAAI,CAAC,CAAC;AACvC,OAAI,CAAC,OAAO,CAAC,WAAW,EAAE,CAAC;AAC3B,OAAI,CAAC,MAAM,EAAE,CAAC;GACd;;;8BAEW;AACX,OAAI,CAAC,GAAG,CAAC,IAAI,EAAE,CAAC;AAChB,OAAI,CAAC,OAAO,CAAC,IAAI,EAAE,CAAC;AACpB,OAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;GACnC;;;2BAEQ;AACR,OAAI,QAAQ,GAAG,IAAI,CAAC,MAAM,CAAC,QAAQ,EAAE,CAAC;;AAEtC,OAAI,QAAQ,EAAE;AACb,QAAI,KAAK,GAAG,IAAI,CAAC,QAAQ,EAAE,CAAC;AAC5B,QAAI,MAAM,GAAG,IAAI,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC,KAAK,CAAC;AAC3C,QAAI,OAAO,GAAG,IAAI,CAAC,QAAQ,CAAC,SAAS,CAAC,CAAC,KAAK,CAAC;;AAE7C,SAAK,CAAC,GAAG,CAAC,UAAU,GAAG,UAAU,CAAC,MAAM,CAAC,CAAC;AAC1C,SAAK,CAAC,GAAG,CAAC,WAAW,GAAG,UAAU,CAAC,OAAO,CAAC,CAAC;;AAE5C,SAAK,CAAC,GAAG,CAAC,SAAS,CAAC,IAAI,CAAC,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,IAAI,CAAC,YAAY,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC;AAChF,SAAK,CAAC,GAAG,CAAC,SAAS,CAAC,KAAK,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC;AACrC,SAAK,CAAC,GAAG,CAAC,SAAS,CAAC,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC;AACpC,SAAK,CAAC,GAAG,CAAC,aAAa,EAAE,CAAC;IAC1B;GACD;;;;;;6BAGU;AACV,OAAI,IAAI,CAAC,MAAM,CAAC,MAAM,GAAG,IAAI,CAAC,SAAS,EAAE;AACxC,QAAI,CAAC,MAAM,CAAC,IAAI,CAAC;AAChB,QAAG,EAAE,IAAI,GAAG,CAAC,IAAI,CAAC,YAAY,CAAC;AAC/B,QAAG,EAAE,IAAI,QAAQ,CAAC,IAAI,CAAC,YAAY,CAAC;KACpC,CAAC,CAAC;IACH;;AAED,OAAI,KAAK,GAAG,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,cAAc,CAAC,CAAC;;AAE7C,OAAI,CAAC,cAAc,GAAG,IAAI,CAAC,cAAc,GAAG,IAAI,CAAC,SAAS,GAAG,CAAC,GAAI,IAAI,CAAC,cAAc,GAAG,CAAC,GAAI,CAAC,CAAC;AAC/F,UAAO,KAAK,CAAC;GACb;;;QApEI,YAAY;;;;;;;;;;;;ICDZ,gBAAgB;AACrB,UADK,gBAAgB,CACT,YAAY,EAAE;wBADrB,gBAAgB;;AAEpB,MAAI,UAAU,GAAG,GAAG,CAAC;AACrB,MAAI,CAAC,YAAY,GAAG,YAAY,CAAC;AACjC,MAAI,CAAC,eAAe,GAAG,IAAI,CAAC,YAAY,CAAC,qBAAqB,CAAC,UAAU,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;AACjF,MAAI,CAAC,GAAG,GAAG,GAAG,CAAC;AACf,MAAI,CAAC,SAAS,GAAG,KAAK,CAAC;AACvB,MAAI,CAAC,iBAAiB,GAAG,CAAC,CAAC;AAC3B,MAAI,CAAC,SAAS,GAAG,IAAI,GAAG,EAAE,CAAC;EAC3B;;;;;AAAA;cATI,gBAAgB;;yBAcd,IAAI,EAAE,KAAK,EAAE;AACnB,QAAK,GAAG,KAAK,IAAI,IAAI,CAAC;AACtB,OAAI,CAAC,SAAS,CAAC,GAAG,CAAC,EAAC,IAAI,EAAE,IAAI,EAAE,KAAK,EAAE,KAAK,EAAC,CAAC,CAAC;GAC/C;;;;;;;;2BAKQ,IAAI,EAAE;AACd,OAAI,KAAK,GAAG,IAAI,CAAC;AACjB,OAAI,KAAK,CAAC,SAAS,CAAC,IAAI,KAAK,CAAC,EAAE,OAAO;;AAEvC,QAAK,CAAC,SAAS,CAAC,OAAO,CAAC,UAAS,QAAQ,EAAC;;AAEzC,QAAI,QAAQ,CAAC,IAAI,KAAK,IAAI,EAAE;AAC3B,UAAK,CAAC,SAAS,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC;AACjC,YAAO;KACP;IACD,CAAC,CAAC;GACH;;;;;;;;wBAKK,GAAG,EAAE;AACV,OAAI,KAAK,GAAG,IAAI,CAAC;AACjB,OAAI,KAAK,CAAC,SAAS,KAAK,IAAI,EAAE,OAAO;;AAErC,QAAK,CAAC,GAAG,GAAG,GAAG,IAAI,KAAK,CAAC,GAAG,CAAC;;AAE7B,QAAK,CAAC,SAAS,GAAG,IAAI,CAAC;AACvB,QAAK,CAAC,eAAe,CAAC,OAAO,CAAC,IAAI,CAAC,YAAY,CAAC,WAAW,CAAC;;;;AAAC,AAI7D,QAAK,CAAC,eAAe,CAAC,cAAc,GAAG,SAAS,mBAAmB,GAAG;AACrE,QAAI,GAAG,GAAG,KAAK,CAAC,YAAY,CAAC,WAAW,CAAC;AACzC,QAAI,cAAc,GAAG,EAAE,GAAG,KAAK,CAAC,GAAG,CAAC;;AAEpC,QAAI,GAAG,IAAI,KAAK,CAAC,iBAAiB,GAAG,cAAc,EAAE;AACpD,UAAK,CAAC,iBAAiB,GAAG,GAAG;;AAAC,AAE9B,UAAK,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;KACvB;IACD,CAAA;GACD;;;;;;;;gCAKa;;AAEb,OAAI,CAAC,MAAM,CAAC,IAAI,CAAC,YAAY,EAAE,IAAI,CAAC,CAAC;AACrC,OAAI,CAAC,KAAK,EAAE,CAAC;GACb;;;;;;;;;;iCAOc;AACd,OAAI,MAAM,GAAG,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,GAAG,GAAG,EAAE,EAAE,EAAE,CAAC,CAAC;AACzC,OAAI,MAAM,GAAG,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,GAAG,GAAG,EAAE,EAAE,GAAG,CAAC,CAAC;AAC1C,OAAI,KAAK,GAAG,CAAC,MAAM,GAAG,MAAM,CAAC;AAC7B,OAAI,CAAC,GAAG,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,MAAM,EAAE,GAAG,KAAK,GAAG,MAAM,CAAC,CAAC;GACtD;;;yBAEM;AACN,OAAI,CAAC,eAAe,CAAC,UAAU,CAAC,IAAI,CAAC,YAAY,CAAC,WAAW,CAAC,CAAC;AAC/D,OAAI,CAAC,SAAS,GAAG,KAAK,CAAC;GACvB;;;yBAEM;AACN,OAAI,CAAC,SAAS,CAAC,OAAO,CAAC,UAAS,QAAQ,EAAE;AACzC,YAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC;IACnC,CAAC,CAAC;GACH;;;QA3FI,gBAAgB;;;;;;;;;;;;ICAhB,qBAAqB;AAC1B,UADK,qBAAqB,CACd,SAAS,EAAE,SAAS,EAAE;wBAD7B,qBAAqB;;AAEzB,MAAI,CAAC,SAAS,GAAG,SAAS,IAAI,CAAC,CAAC;AAAC,AACjC,MAAI,CAAC,SAAS,GAAG,SAAS,IAAI,EAAE;AAAC,AACjC,MAAI,CAAC,UAAU,GAAG,SAAS,CAAC;EAC5B;;cALI,qBAAqB;;oCAMR;AACjB,OAAI,WAAW,GAAG,CAAC,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,SAAS,CAAC;AACnD,OAAI,CAAC,UAAU,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,MAAM,EAAE,GAAG,WAAW,CAAC,GAAG,IAAI,CAAC,SAAS,CAAC;AAC3E,UAAO,IAAI,CAAC,UAAU,CAAC;GACvB;;;2CACwB,SAAS,EAAE;AACnC,OAAI,CAAC,UAAU,GAAG,SAAS,CAAC,MAAM,GAAG,SAAS,CAAC,QAAQ,CAAC,IAAI,CAAC,MAAM,EAAE,GAAG,SAAS,CAAC,MAAM,CAAC,CAAC,GAAG,CAAC,CAAC;AAC/F,UAAO,IAAI,CAAC,UAAU,CAAC;GACvB;;;8BACW;AACX,OAAI,CAAC,UAAU,GAAG,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,UAAU,GAAG,CAAC,GAAG,CAAC,CAAC;AAC7E,UAAO,IAAI,CAAC,UAAU,CAAC;GACvB;;;QAlBI,qBAAqB;;;;;;;;ICHrB,UAAU;AACf,UADK,UAAU,CACH,YAAY,EAAE,SAAS,EAAE,KAAK,EAAE,MAAM,EAAE;wBAD/C,UAAU;;AAEd,MAAI,CAAC,KAAK,GAAG,KAAK,CAAC;AACnB,MAAI,CAAC,MAAM,GAAG,MAAM,CAAC;;AAErB,MAAI,CAAC,MAAM,GAAG,QAAQ,CAAC,aAAa,CAAC,SAAS,CAAC,CAAC;AAChD,MAAI,CAAC,iBAAiB,GAAG,QAAQ,CAAC,aAAa,CAAC,qBAAqB,CAAC,CAAC;AACvE,MAAI,CAAC,MAAM,GAAG,QAAQ,CAAC,aAAa,CAAC,QAAQ,CAAC,CAAC;AAC/C,MAAI,CAAC,MAAM,CAAC,SAAS,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC;AACpC,MAAI,CAAC,MAAM,CAAC,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC;AAC/B,MAAI,CAAC,MAAM,CAAC,MAAM,GAAG,IAAI,CAAC,MAAM,CAAC;AACjC,MAAI,CAAC,MAAM,CAAC,WAAW,CAAC,IAAI,CAAC,iBAAiB,CAAC,CAAC;AAChD,MAAI,CAAC,MAAM,CAAC,WAAW,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;;AAErC,MAAI,CAAC,OAAO,GAAG,QAAQ,CAAC,cAAc,CAAC,YAAY,CAAC,CAAC;;AAErD,MAAI,CAAC,SAAS,GAAG,IAAI,CAAC,MAAM,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC;;AAE9C,MAAI,CAAC,QAAQ,GAAG,YAAY,CAAC,cAAc,EAAE,CAAC;AAC9C,MAAI,CAAC,QAAQ,CAAC,OAAO,GAAG,GAAG,CAAC;;AAE5B,MAAI,CAAC,YAAY,GAAG,IAAI,CAAC,QAAQ,CAAC,iBAAiB,CAAC;AACpD,MAAI,CAAC,SAAS,GAAG,IAAI,UAAU,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC;;AAEnD,WAAS,CAAC,OAAO,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;AACjC,MAAI,CAAC,IAAI,EAAE,CAAC;EACZ;;;AAAA;cA1BI,UAAU;;yBA6BR;AACN,OAAI,KAAK,GAAG,IAAI,CAAC;;AAEjB,QAAK,CAAC,QAAQ,CAAC,qBAAqB,CAAC,KAAK,CAAC,SAAS,CAAC,CAAC;;AAEtD,QAAK,CAAC,SAAS,CAAC,SAAS,GAAI,wBAAwB,CAAC;AACtD,QAAK,CAAC,SAAS,CAAC,QAAQ,CAAC,CAAC,EAAE,CAAC,EAAE,KAAK,CAAC,KAAK,EAAE,KAAK,CAAC,MAAM,CAAC,CAAC;;AAE1D,QAAK,CAAC,SAAS,CAAC,SAAS,GAAG,GAAG,CAAC;AAChC,QAAK,CAAC,SAAS,CAAC,WAAW,GAAG,SAAS,CAAC;;AAExC,QAAK,CAAC,SAAS,CAAC,SAAS,EAAE,CAAC;;AAE5B,OAAI,UAAU,GAAG,KAAK,CAAC,KAAK,GAAG,GAAG,GAAG,KAAK,CAAC,YAAY,CAAC;AACxD,OAAI,CAAC,GAAG,CAAC,CAAC;;AAEV,QAAI,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,KAAK,CAAC,YAAY,EAAE,CAAC,EAAE,EAAE;AAC3C,QAAI,CAAC,GAAG,KAAK,CAAC,SAAS,CAAC,CAAC,CAAC,GAAG,KAAK,CAAC;AACnC,QAAI,CAAC,GAAG,CAAC,GAAG,KAAK,CAAC,MAAM,GAAC,CAAC,CAAC;;AAE3B,QAAG,CAAC,KAAK,CAAC,EAAE;AACX,UAAK,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;KAC7B,MAAM;AACN,UAAK,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;KAC7B;;AAED,KAAC,IAAI,UAAU,CAAC;IAChB;;AAED,QAAK,CAAC,SAAS,CAAC,MAAM,EAAE,CAAC;;AAEzB,SAAM,CAAC,qBAAqB,CAAC,YAAW;AACvC,SAAK,CAAC,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC;IACxB,CAAC,CAAC;GACA;;;QA/DC,UAAU","file":"app.js","sourcesContent":["/**\n * Simple semantic wrapper for AudioNode functionality\n *\n * AudioCable.cable is simply an exposed GainNode\n */\nclass AudioCable {\n\tconstructor(audioContext) {\n\t\tthis.audioContext = audioContext;\n\t\tthis.cable = this.audioContext.createGain();\n\t}\n\n\tconnectTo(audioNode) {\n\t\tthis.cable.connect(audioNode);\n\t}\n\n\tdisconnectFrom(audioNode) {\n\t\tthis.cable.disconnect(audioNode);\n\t}\n}","/**\n * Bus is a \"mixer bus\"-type utility which\n * supports basic insert effect(s) capability,\n * with a global wet/dry to all the insert effects\n *\n * TODO: Wet/dry mixing doesn't seem to work on mobile.\n */\nclass Bus extends AudioCable {\n\tconstructor(audioContext) {\n\t\tsuper(audioContext);\n\t\tthis.dry    = new AudioCable(audioContext);\n\t\tthis.wet    = new AudioCable(audioContext);\n\t\tthis.master = new AudioCable(audioContext);\n\t\tthis.effects = new Set();\n\t\tthis.gain = 1;\n\t\t// Internally split signal into two\n\t\tthis.cable.connect(this.dry.cable);\n\t\tthis.cable.connect(this.wet.cable);\n\t\t// Connect both signals to \"master\"\n\t\tthis.dry.connectTo(this.master.cable);\n\t\tthis.wet.connectTo(this.master.cable);\n\t}\n\n\tconnectTo(audioNode) {\n\t\t// Expose master instead of this.cable\n\t\tthis.master.connectTo(audioNode);\n\t}\n\n\tdisconnectFrom(audioNode) {\n\t\tthis.master.disconnectFrom(audioNode);\n\t}\n\n\tmute() {\n\t\tthis.master.cable.gain.value = 0;\n\t\tthis.master.cable.gain.value = 0;\n\t}\n\n\tunmute() {\n\t\tthis.master.cable.gain.value = this.gain;\n\t}\n\n\twetBalance(balance) {\n\t\tthis.dry.cable.gain.value = 1 - balance;\n\t\tthis.wet.cable.gain.value = balance;\n\t}\n\n\tinsertEffect(effect) {\n\t\tthis.cable.disconnect(this.wet.cable);\n\t\tthis.effects.add(effect);\n\t\tthis.buildEffectChain();\n\t}\n\n\tremoveEffect(effect) {\n\t\tif (this.effects.delete(effect)) {\n\t\t\tthis.buildEffectChain();\n\t\t}\n\t}\n\n\tbuildEffectChain() {\n\t\tlet currEffectIx = 0;\n\t\tlet previousEffect = {};\n\t\tlet _this = this;\n\n\t\tthis.effects.forEach(function(effect) {\n\t\t\teffect.cable.disconnect();\n\t\t\t// First effect needs to be hooked to the wet cable\n\t\t\tif (currEffectIx === 0) {\n\t\t\t\teffect.connectTo(_this.wet.cable);\n\t\t\t\t_this.cable.connect(effect.cable);\n\t\t\t} else {\n\t\t\t\t_this.effect.connectTo(previousEffect);\n\t\t\t}\n\n\t\t\tcurrEffectIx++;\n\t\t\tpreviousEffect = effect; // Will this crash?\n\t\t});\n\t}\n}","/**\n * Connect an AudioNode to the envelope\n */\nclass Envelope extends AudioCable {\n\tconstructor(audioContext) {\n\t\tsuper(audioContext);\n\t\tthis.attackTime = 0.1;  // 100ms\n\t\tthis.releaseTime = 0.5; // 500ms\n\t}\n\n\tapplyEnvelope() {\n\t\tlet now = this.audioContext.currentTime;\n\t\tthis.cable.gain.setValueAtTime(0.0, now);\n\t\tthis.cable.gain.linearRampToValueAtTime(1.0, now + this.attackTime);\n\t\tthis.cable.gain.linearRampToValueAtTime(0.0, now + this.attackTime + this.releaseTime);\n\t}\n}","(() => {\n\tvar initialized = false;\n\tvar eventType = 'click';\n\tvar playEl = document.querySelector('.playButton')\n\tvar analyserCanvas = document.getElementById('analyser');\n\n\tvar sm = {};\n\tvar vis = {};\n\n\tif ('touchend' in window)\n\t\teventType = 'touchend';\n\n\t// We need to wait until a touchend event occurs on mobile\n\tplayEl.addEventListener(eventType, playHandler);\n\n\tfunction playHandler(evt) {\n\t\tif (!initialized) {\n\t\t\tsm = new SoundMachine();\n\t\t\tvis = new Visualiser(sm.audioContext, sm.bus.master.cable, analyserCanvas.offsetWidth, analyserCanvas.offsetHeight);\n\t\t\tinitialized = true;\n\t\t}\n\n\t\tevt.preventDefault();\n\n\t\tvar icon = playEl.querySelector('span');\n\t\tif (icon.classList.contains('play--paused')) {\n\t\t\ticon.classList.remove('play--paused');\n\t\t\ticon.classList.add('play--playing');\n\t\t\tsm.startSound();\n\n\t\t} else {\n\t\t\ticon.classList.remove('play--playing');\n\t\t\ticon.classList.add('play--paused');\n\t\t\tsm.stopSound();\n\t\t}\n\t}\n})();\n","class MelodyGenerator {\n\tconstructor() {\n\t\tthis.noteGroups = [\n\t\t\t['c4', 'a3', 'c4', 'e3', 'g4',   '', 'd5', ''],\n\t\t\t['d4', 'a4', 'f4', 'f3', 'e4', 'd3',   '', ''],\n\t\t\t['e4', 'd4', 'c4', 'g3', 'e3',   '', 'a3', ''],\n\t\t\t['d3', 'f4', 'c4', 'd4',   '', 'a4', 'a3', '']\n\t\t];\n\n\t\tthis.currentStep = 1;\n\t\tthis.currentGroupIx = 0;\n\t}\n\n\tnextNote() {\n\t\tvar noteIx = this.currentStep % this.noteGroups[this.currentGroupIx].length;\n\t\tvar note = '';\n\n\t\t// At the end of each note group - pick a new, random group\n\t\tif (noteIx === 0) {\n\t\t\tthis.currentGroupIx = Math.floor(Math.random() * this.noteGroups.length);\n\t\t\tnoteIx = this.noteGroups[this.currentGroupIx].length;\n\t\t}\n\n\t\tnote = this.noteGroups[this.currentGroupIx][noteIx - 1];\n\t\tthis.currentStep++;\n\n\t\treturn note !== '' ? note : false\n\t}\n\n}","/**\n * Handles note to hertz conversions\n */\nclass Note {\n\tconstructor(scaleName) {\n\t\tthis.scales = {\n\t\t\tBOHLEN_PIERCE: {\n\t\t\t\tnoteDelta: 1.08818,\n\t\t\t\tbaseFrequency: 10,\n\t\t\t\tbaseOffset: 0,\n\t\t\t\tminOffset: -45,\n\t\t\t\tmaxOffset: 45,\n\t\t\t},\n\t\t\tEQUAL_TEMPERED: {\n\t\t\t\tnoteDelta: 1.0594545454545454,\n\t\t\t\tbaseFrequency: 16.3591205, // C0 - http://www.phy.mtu.edu/~suits/notefreqs.html\n\t\t\t\tbaseOffset: 0,   // 36 = C3 TODO: Remove?\n\t\t\t\tminOffset: 0,    // C0\n\t\t\t\tmaxOffset: 108,  // B8\n\t\t\t\tbaseNotes: ['c', 'c#', 'd', 'd#', 'e', 'f', 'f#', 'g', 'g#', 'a', 'a#', 'b']\n\t\t\t}\n\t\t};\n\n\t\tthis.setScale(scaleName || 'BOHLEN_PIERCE');\n\t}\n\n\t/**\n\t * Set the scale to be used for hertz conversion\n\t */\n\tsetScale(scaleName) {\n\t\tif (typeof this.scales[scaleName] !== 'undefined') {\n\t\t\tthis.scale = this.scales[scaleName];\n\t\t}\n\t}\n\n\t/**\n\t * Takes a note offset, adds to base offset and\n\t * returns it's corresponding hz\n\t */\n\tnoteOffsetToHz(offset) {\n\t\t// Add base offset to passed offset\n\t\toffset += this.scale.baseOffset; // TODO: Remove?\n\t\t// Make sure result is still in range\n\t\toffset = Math.min(this.scale.maxOffset, Math.max(this.scale.minOffset, offset));\n\t\t// Zero offsets are === baseOffset\n\t\toffset = offset === 0 ? this.scale.baseOffset : offset;\n\t\t// Convert to hertz\n\t\treturn this.scale.baseFrequency * Math.pow(this.scale.noteDelta, offset);\n\t}\n\n\t/**\n\t * Takes a note as string and returns an offset on the scale\n\t * The following works: \"C2\", \"C\", \"C#\", \"C#2\"\n\t * If the octave is not specified, we fall back to 3\n\t *\n\t * Only works with the EQUAL_TEMPERED scale right now\n\t */\n\tnoteToOffset(noteString) {\n\t\tif (typeof this.scale.baseNotes === 'undefined') return;\n\n\t\tlet splitString = noteString.split(/(\\d)/);\n\t\tlet note = splitString[0];\n\t\tlet oct = splitString.length > 1 ? splitString[1] : 3;\n\t\tlet noteOffset = oct * this.scale.baseNotes.length + this.scale.baseNotes.indexOf(note);\n\t\treturn noteOffset;\n\t}\n}","/**\n * A digitally controlled oscillator\n * Creates an oscillator that attaches itself to an audiocontext\n * while exposing conveince methods for setting frequency in hertz.\n *\n * @param AudioContext audioContext\n */\nclass DCO extends AudioCable {\n\tconstructor(audioContext) {\n\t\tsuper(audioContext);\n\t\tthis.oscNode = this.audioContext.createOscillator();\n\t\tthis.defaultFrequency = 220;\n\t\tthis.oscNode.type = 'sine';\n\t\tthis.oscNode.frequency.value = this.defaultFrequency;\n\t\tthis.oscNode.connect(this.cable);\n\t\t// The oscillator is always \"running\"\n\t\t// TODO: Research cost of killing and creating on stop and start\n\t\tthis.oscNode.start(0);\n\t}\n\twaveform(waveformType) {\n\t\tthis.oscNode.type = waveformType || 'sine';\n\t}\n\tfrequency(hz) {\n\t\tthis.oscNode.frequency.setValueAtTime(hz, this.audioContext.currentTime);\n\t}\n}","class Reverb extends AudioCable {\n\tconstructor(audioContext) {\n\t\tsuper(audioContext);\n\t\tthis.seconds = 5;\n\t\tthis.decay = 3;\n\t\tthis.cable = this.audioContext.createConvolver(); // Replace GainNode with ConvolverNode\n\t\tthis.createImpulse();\n\t}\n\n\tcreateImpulse(length, decay) {\n\t\tvar rate = this.audioContext.sampleRate;\n\t\tvar length = rate * this.seconds; // 48000 * seconds\n\t\tvar decay = this.decay;\n\t\tvar impulse = this.audioContext.createBuffer(2, length, rate);\n\t\tvar impulseL = impulse.getChannelData(0);\n\t\tvar impulseR = impulse.getChannelData(1);\n\t\tvar n, i = 0;\n\n\t\tconsole.time('building impulse');\n\t\tfor (; i < length; i++) {\n\t\t\tn = this.reverse ? length - i : i;\n\t\t\timpulseL[i] = (Math.random() * 2 - 1) * Math.pow(1 - n / length, decay);\n\t\t\timpulseR[i] = (Math.random() * 2 - 1) * Math.pow(1 - n / length, decay);\n\t\t}\n\t\tconsole.timeEnd('building impulse');\n\n\t\tthis.cable.buffer = impulse;\n\t}\n}","/**\n * Duct tapes the parts together into a\n * sounding machine.\n */\nclass SoundMachine {\n\tconstructor() {\n\t\tvar AudioContext = window.AudioContext || window.webkitAudioContext || false;\n\t\tif (!AudioContext) return;\n\n\t\t// Polyphony\n\t\tthis.maxVoices = 6;\n\t\tthis.currentVoiceIx = 0;\n\t\tthis.voices = [];\n\n\t\tthis.audioContext = new AudioContext();\n\t\tthis.note         = new Note('EQUAL_TEMPERED');\n\t\tthis.rng          = new RandomOffsetGenerator(-5, 12);\n\t\tthis.melody       = new MelodyGenerator();\n\t\tthis.trigGen      = new TriggerGenerator(this.audioContext);\n\t\tthis.bus          = new Bus(this.audioContext);\n\t\tthis.reverb       = new Reverb(this.audioContext);\n\t\tthis.controls     = document.querySelector('.controls').elements;\n\n\t\tthis.bus.insertEffect(this.reverb);\n\t\tthis.bus.wetBalance(0.4);\n\t\tthis.bus.connectTo(this.audioContext.destination);\n\t}\n\n\tstartSound() {\n\t\tthis.bus.unmute();\n\t\tthis.trigGen.listen(this.onTrig, this);\n\t\tthis.trigGen.startRandom();\n\t\tthis.onTrig();\n\t}\n\n\tstopSound() {\n\t\tthis.bus.mute();\n\t\tthis.trigGen.stop();\n\t\tthis.trigGen.unListen(this.onTrig);\n\t}\n\n\tonTrig() {\n\t\tvar nextNote = this.melody.nextNote();\n\n\t\tif (nextNote) {\n\t\t\tvar voice = this.getVoice();\n\t\t\tvar attack = this.controls['attack'].value;\n\t\t\tvar release = this.controls['release'].value;\n\n\t\t\tvoice.env.attackTime = parseFloat(attack);\n\t\t\tvoice.env.releaseTime = parseFloat(release);\n\n\t\t\tvoice.osc.frequency(this.note.noteOffsetToHz(this.note.noteToOffset(nextNote)));\n\t\t\tvoice.osc.connectTo(voice.env.cable);\n\t\t\tvoice.env.connectTo(this.bus.cable);\n\t\t\tvoice.env.applyEnvelope();\n\t\t}\n\t}\n\n\t// Simple polyphony\n\tgetVoice() {\n\t\tif (this.voices.length < this.maxVoices) {\n\t\t\tthis.voices.push({\n\t\t\t\tosc: new DCO(this.audioContext),\n\t\t\t\tenv: new Envelope(this.audioContext)\n\t\t\t});\n\t\t}\n\n\t\tvar voice = this.voices[this.currentVoiceIx];\n\n\t\tthis.currentVoiceIx = this.currentVoiceIx < this.maxVoices - 1 ? (this.currentVoiceIx + 1) : 0;\n\t\treturn voice;\n\t};\n}","/**\n * Triggers an event every beat at a set BPM\n */\nclass TriggerGenerator {\n\tconstructor(audioContext) {\n\t\tlet bufferSize = 256;\n\t\tthis.audioContext = audioContext;\n\t\tthis.scriptProcessor = this.audioContext.createScriptProcessor(bufferSize, 1, 1);\n\t\tthis.bpm = 100;\n\t\tthis.isRunning = false;\n\t\tthis.timeOfLastTrigger = 0;\n\t\tthis.listeners = new Set();\n\t}\n\n\t/**\n\t * Simple trigger listener registration\n\t */\n\tlisten(func, scope) {\n\t\tscope = scope || this;\n\t\tthis.listeners.add({func: func, scope: scope});\n\t}\n\n\t/**\n\t * Unlisten to triggers.\n\t */\n\tunListen(func) {\n\t\tlet _this = this;\n\t\tif (_this.listeners.size === 0) return;\n\n\t\t_this.listeners.forEach(function(listener){\n\t\t\t// This func already registered? Remove.\n\t\t\tif (listener.func === func) {\n\t\t\t\t_this.listeners.delete(listener);\n\t\t\t\treturn;\n\t\t\t}\n\t\t});\n\t}\n\n\t/**\n\t * Start triggering @ optional bpm\n\t */\n\tstart(bpm) {\n\t\tlet _this = this;\n\t\tif (_this.isRunning === true) return;\n\n\t\t_this.bpm = bpm || _this.bpm;\n\n\t\t_this.isRunning = true;\n\t\t_this.scriptProcessor.connect(this.audioContext.destination); // TODO: Remove?\n\n\t\t// Experiment using the very precise onaudioprocess+currentTime combo\n\t\t// of figuring out if a trig is going to be executed.\n\t\t_this.scriptProcessor.onaudioprocess = function audioProcessHandler() {\n\t\t\tlet now = _this.audioContext.currentTime;\n\t\t\tlet beatsPerSecond = 60 / _this.bpm;\n\n\t\t\tif (now >= _this.timeOfLastTrigger + beatsPerSecond) {\n\t\t\t\t_this.timeOfLastTrigger = now;\n\t\t\t\t// Call trig listeners\n\t\t\t\t_this.trig.call(_this);\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Start triggering at random intervals\n\t */\n\tstartRandom() {\n\t\t// Each \"beat\" will trigger setRandomBpm\n\t\tthis.listen(this.setRandomBpm, this);\n\t\tthis.start();\n\t}\n\n\t/**\n\t * Each new bpm is based on the previous value,\n\t * making it gradually swing towards faster or\n\t * slower tempos.\n\t */\n\tsetRandomBpm() {\n\t\tvar minBpm = Math.max(this.bpm - 40, 10);\n\t\tvar maxBpm = Math.min(this.bpm + 40, 180);\n\t\tvar range = -minBpm + maxBpm;\n\t\tthis.bpm = Math.floor(Math.random() * range + minBpm);\n\t}\n\n\tstop() {\n\t\tthis.scriptProcessor.disconnect(this.audioContext.destination);\n\t\tthis.isRunning = false;\n\t}\n\n\ttrig() {\n\t\tthis.listeners.forEach(function(listener) {\n\t\t\tlistener.func.call(listener.scope);\n\t\t});\n\t}\n}","/**\n * Generates a random number from a specified range.\n */\nclass RandomOffsetGenerator {\n\tconstructor(minOffset, maxOffset) {\n\t\tthis.minOffset = minOffset || -2; // Offsets below 0\n\t\tthis.maxOffset = maxOffset || 12; // Offsets above 0\n\t\tthis.lastOffset = minOffset;\n\t}\n\tgetRandomOffset() {\n\t\tvar randomRange = -this.minOffset + this.maxOffset;\n\t\tthis.lastOffset = Math.round(Math.random() * randomRange) + this.minOffset;\n\t\treturn this.lastOffset;\n\t}\n\tgetRandomOffsetFromArray(noteArray) {\n\t\tthis.lastOffset = noteArray.length ? noteArray[parseInt(Math.random() * noteArray.length)] : 0;\n\t\treturn this.lastOffset;\n\t}\n\ttestScale() {\n\t\tthis.lastOffset = this.lastOffset < this.maxOffset ? this.lastOffset + 1 : 0;\n\t\treturn this.lastOffset;\n\t}\n}","class Visualiser {\n\tconstructor(audioContext, audioNode, width, height) {\n\t\tthis.width = width;\n\t\tthis.height = height;\n\n\t\tthis.player = document.querySelector('.player');\n\t\tthis.canvasPlaceholder = document.querySelector('.canvas-placeholder');\n\t\tthis.canvas = document.createElement('canvas');\n\t\tthis.canvas.classList.add('canvas');\n\t\tthis.canvas.width = this.width;\n\t\tthis.canvas.height = this.height;\n\t\tthis.player.removeChild(this.canvasPlaceholder);\n\t\tthis.player.appendChild(this.canvas);\n\n\t\tthis.levelEl = document.getElementById('soundLevel');\n\n\t\tthis.canvasCtx = this.canvas.getContext('2d');\n\n\t\tthis.analyser = audioContext.createAnalyser();\n\t\tthis.analyser.fftSize = 512;\n\n\t\tthis.bufferLength = this.analyser.frequencyBinCount;\n\t\tthis.dataArray = new Uint8Array(this.bufferLength);\n\n\t\taudioNode.connect(this.analyser);\n\t\tthis.draw();\n\t}\n\n\t// draw an oscilloscope of the current audio source\n\tdraw() {\n\t\tlet _this = this;\n\n\t\t_this.analyser.getByteTimeDomainData(_this.dataArray);\n\n\t\t_this.canvasCtx.fillStyle =  'rgba(34, 70, 108, 0.3)';\n\t\t_this.canvasCtx.fillRect(0, 0, _this.width, _this.height);\n\n\t\t_this.canvasCtx.lineWidth = 2.5;\n\t\t_this.canvasCtx.strokeStyle = '#BAA847';\n\n\t\t_this.canvasCtx.beginPath();\n\n\t\tlet sliceWidth = _this.width * 1.0 / _this.bufferLength;\n\t\tlet x = 0;\n\n\t\tfor(var i = 0; i < _this.bufferLength; i++) {\n\t\t\tvar v = _this.dataArray[i] / 128.0;\n\t\t\tvar y = v * _this.height/2;\n\n\t\t\tif(i === 0) {\n\t\t\t\t_this.canvasCtx.moveTo(x, y);\n\t\t\t} else {\n\t\t\t\t_this.canvasCtx.lineTo(x, y);\n\t\t\t}\n\n\t\t\tx += sliceWidth;\n\t\t}\n\n\t\t_this.canvasCtx.stroke();\n\n\t\twindow.requestAnimationFrame(function() {\n\t\t\t_this.draw.apply(_this);\n\t\t});\n    }\n}"],"sourceRoot":"/source/"}